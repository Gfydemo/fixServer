(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1638"],{5913:function(e,t,a){"use strict";var i=a("Q8Ng");a.n(i).a},BOeb:function(e,t,a){"use strict";var i=a("vDqi"),n=a.n(i),r={props:{value:{type:String}},data:function(){return{currentValue:this.value,uploadData:{token:""}}},methods:{getToken:function(){var e=this;n.a.get("http://upload.yaojunrong.com/getToken").then(function(t){200==t.data.code?e.uploadData={token:t.data.data}:e.$message.info(t.data.msg)})},uploadSuccess:function(e){console.log(e),this.currentValue=e.url}},created:function(){this.getToken()},watch:{value:function(e){this.currentValue=e},currentValue:function(e){this.$emit("input",e)}}},o=(a("5913"),a("KHd+")),s=Object(o.a)(r,function(){var e=this.$createElement,t=this._self._c||e;return t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://upload-z1.qiniup.com",data:this.uploadData,"show-file-list":!1,"on-success":this.uploadSuccess}},[this.currentValue?t("img",{staticClass:"avatar",attrs:{src:this.currentValue,alt:""}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])},[],!1,null,null,null);s.options.__file="index.vue";t.a=s.exports},EQcD:function(e,t,a){"use strict";a.r(t);var i=a("P2sY"),n=a.n(i),r=a("XJYT"),o=a("BOeb"),s=a("t3Un");var l={data:function(){return{page:1,size:6,count:0,memberForm:{id:"",name:"",img:"",category:""},memberFormRules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],img:[{required:!0,message:"图片不能为空",trigger:"blur"}]},dialogTitle:"create",dialogStatus:{create:"添加",update:"修改"},list:[],listLoading:!1,dialogVisible:!1}},components:{uploadAvatar:o.a},created:function(){this.getList()},methods:{handleCurrentChange:function(e){this.page=e},getList:function(){var e=this;this.listLoading=!0,s.a.get("/repairType/getAll").then(function(t){e.listLoading=!1,e.list=t.data,e.count=e.list.length})},handleCreate:function(){this.resetForm(),this.dialogVisible=!0,this.dialogTitle="create"},handleUpdate:function(e){this.resetForm(),this.dialogVisible=!0,this.dialogTitle="update",this.memberForm=n()({},e),console.log(this.memberForm)},create:function(){var e=this;this.$refs.memberForm.validate(function(t){if(!t)return!1;(function(e){return s.a.post("/repairType/add",e)})({img:e.memberForm.img,name:e.memberForm.name,category:e.memberForm.category}).then(function(t){200===t.code?r.Message.success("添加成功"):r.Message.error(t.msg),e.dialogVisible=!1,e.getList()})})},update:function(){var e=this;this.$refs.memberForm.validate(function(t){if(!t)return!1;(function(e){return s.a.post("/repairType/update",e)})(e.memberForm).then(function(t){200===t.code?r.Message.success("修改成功"):r.Message.error(t.msg),e.dialogVisible=!1,e.getList()})})},handleDelete:function(e){var t=this;this.$confirm("是否删除此条数据？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){return s.a.post("/repairType/del",e)})({_id:e._id}).then(function(e){200===e.code?r.Message.success("删除成功"):r.Message.error(e.msg),t.getList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},resetForm:function(){this.memberForm={name:"",img:""}}}},c=(a("hjCe"),a("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"mini"},on:{click:e.handleCreate}},[e._v("添 加")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list.slice((e.page-1)*e.size,e.page*e.size),"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"报修类别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.category)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"报修类型图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"avatar-item",attrs:{src:e.row.img,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"报修类型名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.name)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogStatus[e.dialogTitle],visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"memberForm",attrs:{rules:e.memberFormRules,model:e.memberForm,"label-position":"right","label-width":"160px"}},[a("el-form-item",{attrs:{label:"报修类别",prop:"name"}},[a("el-input",{attrs:{placeholder:"name"},model:{value:e.memberForm.category,callback:function(t){e.$set(e.memberForm,"category",t)},expression:"memberForm.category"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"报修类型图片",prop:"img"}},[a("uploadAvatar",{model:{value:e.memberForm.img,callback:function(t){e.$set(e.memberForm,"img",t)},expression:"memberForm.img"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"报修类型名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"name"},model:{value:e.memberForm.name,callback:function(t){e.$set(e.memberForm,"name",t)},expression:"memberForm.name"}})],1)],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"===e.dialogTitle?a("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("添 加")]):e._e(),e._v(" "),"update"===e.dialogTitle?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.update()}}},[e._v("修 改")]):e._e()],1)],1)],1),e._v(" "),a("el-pagination",{staticClass:"flr",staticStyle:{"margin-top":"20px"},attrs:{"page-size":e.size,"current-page":e.page,layout:"prev, pager, next",total:e.count},on:{"current-change":e.handleCurrentChange}})],1)},[],!1,null,"59adde82",null);u.options.__file="index.vue";t.default=u.exports},Q8Ng:function(e,t,a){},R6da:function(e,t,a){},hjCe:function(e,t,a){"use strict";var i=a("R6da");a.n(i).a}}]);